import type { AbstractModuleId, BundleDefinition, BundleProvider, ProviderContext, RuntimeEnvironment, RuntimeParams, SiteBundle, SiteMetadata } from '@lwrjs/types';
import { LRUCache } from 'lru-cache';
export default class StaticBundleProvider implements BundleProvider {
    name: string;
    codeCache: LRUCache<string, string, unknown> | undefined;
    siteRootDir: string;
    bundleConfig: import("@lwrjs/types").BundleConfig;
    i18n: import("@lwrjs/types").I18NConfig;
    siteMetadata: SiteMetadata;
    bundleCacheSize: number;
    constructor(config: {
        bundleCacheSize?: number;
    }, context: ProviderContext);
    bundle<BundleIdentifier extends AbstractModuleId, RE extends RuntimeEnvironment>(moduleId: BundleIdentifier, runtimeEnvironment: RE, runtimeParams: RuntimeParams): Promise<BundleDefinition | undefined>;
    private createBundleDefinition;
    getBundleMetadata({ moduleId, localeId, debug, ssr, }: {
        moduleId: Partial<AbstractModuleId>;
        localeId: string;
        debug: boolean;
        ssr: boolean;
    }): SiteBundle | undefined;
    /**
     * Takes a key from the site bundle metadata and creates an appropriate runtime BaseModuleReference to use in the LWR runtime.
     */
    private getModuleReference;
    getCodePromiser(bundleSourcePath: string, { specifier, version, locale, ssr, debug, }: {
        specifier: string;
        version?: string;
        locale: string;
        ssr: boolean;
        debug: boolean;
    }): () => Promise<string>;
    /**
     * Logs an error when a bundle fails to load and provides debugging metadata.
     *
     * This function logs details about the failed bundle load attempt, including the module ID,
     * locale, debug mode, and SSR status. It also attempts to retrieve additional metadata
     * about the site bundles and debug bundles associated with the module.
     *
     * @param {Partial<AbstractModuleId>} moduleId - The module identifier, which may include a namespace and name.
     * @param {string} localeId - The locale associated with the bundle.
     * @param {boolean} debug - Indicates whether debug mode is enabled.
     * @param {boolean} ssr - Indicates whether the bundle is for server-side rendering (SSR).
     */
    logBundleError(moduleId: Partial<AbstractModuleId>, localeId: string, debug: boolean, ssr: boolean): void;
    /**
     * Get the local source code path for the a static bundle
     * If we are running in a lambda and the mode is debug we will return the prod source code instead of the debug source code
     *
     * @param bundlePath The default path for the bundle for prod read from .metadata/bundle-metadata.json, for debug .metadata/bundle-metadata-debug.json
     * @param debug Is the request in debug mode?
     * @param specifier Root specifier for the requested bundle
     * @param version Root specifier version
     * @param localeId Locale id (e.g. en-US) for the current request
     * @param ssr True if this is a server bundle
     */
    getCodePath(bundlePath: string, debug: boolean, specifier: string, version: string | undefined, localeId: string, ssr: boolean): string;
}
//# sourceMappingURL=static-bundle-provider.d.ts.map