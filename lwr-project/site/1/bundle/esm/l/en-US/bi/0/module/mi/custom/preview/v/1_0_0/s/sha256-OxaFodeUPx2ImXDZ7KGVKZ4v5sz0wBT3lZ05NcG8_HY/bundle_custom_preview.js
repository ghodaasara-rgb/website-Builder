import{parseFragment as l,registerTemplate as h,freezeTemplate as u,registerDecorators as m,registerComponent as y,LightningElement as f}from"/1/bundle/esm/l/en-US/bi/0/module/mi/lwc%2Fv%2F8_28_0/s/sha256-YEjxo0QDCp_Ri6v5gTkCFurICNw6jRY4sdZ3D70_fxc/bundle_lwc.js";function Y(s,t,o){var e=s?"["+s+"]":"",r=s?"-"+s:"";return".preview-container"+e+" {display: flex;flex-direction: column;height: 100vh;background-color: #f8f9fa;}.preview-content"+e+" {flex: 1;overflow-y: auto;padding: 0;}.loading"+e+" {display: flex;flex-direction: column;align-items: center;justify-content: center;height: 400px;gap: 16px;}.spinner"+e+" {width: 40px;height: 40px;border: 4px solid #e2e8f0;border-top-color: #4f46e5;border-radius: 50%;animation: spin"+r+" 0.8s linear infinite;}@keyframes spin"+r+" {to {transform: rotate(360deg);}}.loading"+e+" p"+e+" {color: #64748b;font-size: 14px;}.page-preview"+e+" {background-color: var(--s-bg-page, white);min-height: 100%;padding-bottom: 64px;}.empty-state"+e+" {display: flex;flex-direction: column;align-items: center;justify-content: center;height: 400px;gap: 16px;text-align: center;}.empty-state"+e+" h2"+e+" {font-size: 24px;font-weight: 600;color: #1a202c;margin-bottom: 8px;}.empty-state"+e+" p"+e+" {font-size: 16px;color: #64748b;}.btn-primary"+e+" {padding: 10px 20px;background-color: #4f46e5;color: white;border: none;border-radius: 6px;cursor: pointer;font-weight: 500;}.site-header"+e+" {width: 100%;box-sizing: border-box;background-color: white;border-bottom: 1px solid #e5e7eb;}.header-content"+e+" {display: flex;justify-content: space-between;align-items: center;width: 100%;max-width: 1200px;margin: 0 auto;padding: 1rem 2rem;}.header-logo"+e+" {display: flex;align-items: center;gap: 0.75rem;}.header-logo"+e+" img"+e+" {max-height: 40px;width: auto;}.header-logo"+e+" .logo-text"+e+" {font-size: 1.5rem;font-weight: 700;}.header-nav"+e+" ul"+e+" {display: flex;list-style: none;margin: 0;padding: 0;gap: 1.5rem;}.header-nav"+e+" a"+e+" {text-decoration: none;color: inherit;font-weight: 500;cursor: pointer;}"}var z=[Y];function W(s,t,o){var e=s?"["+s+"-host]":"";return(t?":host {":e+" {")+"display: block;}"}var E=[W];const J=l`<section class="container${0}"${"s0"}${2}><div class="grid${0}"${2}><div class="col-span-12${0}" style="text-align: center; z-index: 1; position: relative;"${2}><h1${"s3"}${3}>${"t4"}</h1><p${"s5"}${3}>${"t6"}</p><div style="display: flex; gap: 1rem; justify-content: center;"${3}><a href="#" class="btn btn--primary btn--lg${0}"${2}>${"t9"}</a><a href="#" class="btn btn--secondary btn--lg${0}"${2}>${"t11"}</a></div></div></div></section>`;function $(s,t,o,e){const{d:r,sp:a,st:n}=s;return[n(J,1,[a(0,{style:t.sectionStyle},null),a(3,{style:t.headlineStyle},null),a(4,null,r(t.title)),a(5,{style:t.subtitleStyle},null),a(6,null,r(t.subtitle)),a(9,null,r(t.ctaText)),a(11,null,r(t.ctaSecondaryText))])]}var O=h($);$.stylesheets=[],$.stylesheetToken="lwc-chdq17c5gt",$.legacyStylesheetToken="components-hero_hero",E&&$.stylesheets.push.apply($.stylesheets,E),u($);class L extends f{constructor(...t){super(...t);this.title="Welcome to FlexSite",this.subtitle="Built with the Custom CSS Framework",this.ctaText="Get Started",this.ctaSecondaryText="Learn More",this.backgroundImage="",this.textColor="#ffffff"}get sectionStyle(){const t="padding: 4rem 0;";return this.backgroundImage?`${t} background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('${this.backgroundImage}'); background-size: cover; background-position: center; position: relative;`:t}get headlineStyle(){return`font-size: 2.5rem; font-weight: 700; margin-bottom: 1rem; color: ${this.textColor}; text-shadow: 0 2px 4px rgba(0,0,0,0.5);`}get subtitleStyle(){return`font-size: 1.25rem; margin-bottom: 2rem; color: ${this.textColor}; opacity: 0.95; text-shadow: 0 1px 2px rgba(0,0,0,0.5);`}}L.renderMode="light",m(L,{publicProps:{title:{config:0},subtitle:{config:0},ctaText:{config:0},ctaSecondaryText:{config:0},backgroundImage:{config:0},textColor:{config:0}}});const K=y(L,{tmpl:O,sel:"components-hero",apiVersion:66}),Q=l`<section class="container${0}" style="padding: 4rem 0;"${2}><h2 style="text-align: center; margin-bottom: 2rem;"${3}>${"t2"}</h2><div class="grid${0}"${2}><div class="col-span-4${0}"${2}><div class="card${0}" style="height: 100%;"${2}><div class="card-header${0}"${2}><h3 class="card-title${0}"${2}>Drag &amp; Drop</h3></div><div class="card-body${0}"${2}><p style="color: var(--s-text-secondary);"${3}>Easily build pages by dragging components.</p></div></div></div><div class="col-span-4${0}"${2}><div class="card${0}" style="height: 100%;"${2}><div class="card-header${0}"${2}><h3 class="card-title${0}"${2}>Responsive</h3></div><div class="card-body${0}"${2}><p style="color: var(--s-text-secondary);"${3}>Layouts adapt perfectly to any device size.</p></div></div></div><div class="col-span-4${0}"${2}><div class="card${0}" style="height: 100%;"${2}><div class="card-header${0}"${2}><h3 class="card-title${0}"${2}>Customizable</h3></div><div class="card-body${0}"${2}><p style="color: var(--s-text-secondary);"${3}>Powered by your Custom CSS Framework.</p></div></div></div></div></section>`;function P(s,t,o,e){const{d:r,sp:a,st:n}=s;return[n(Q,1,[a(2,null,r(t.title))])]}var Z=h(P);P.stylesheets=[],P.stylesheetToken="lwc-32bflh7ts20",P.legacyStylesheetToken="components-features_features",u(P);class F extends f{constructor(...t){super(...t);this.title="Features"}}F.renderMode="light",m(F,{publicProps:{title:{config:0}}});const X=y(F,{tmpl:Z,sel:"components-features",apiVersion:66});function tt(s,t,o){var e=s?"["+s+"-host]":"";return(t?":host {":e+" {")+"display: block;}"}var N=[tt];const et=l`<footer class="container${0}" style="padding: 2rem 0; border-top: 1px solid var(--s-border-default); margin-top: 4rem;"${2}><div class="grid${0}"${2}><div class="col-span-6${0}"${2}><strong style="color: var(--s-text-primary);"${3}>FlexSite</strong><p style="color: var(--s-text-secondary); font-size: 0.875rem;"${3}>${"t6"}</p></div><div class="col-span-6${0}" style="text-align: right;"${2}><a href="#" style="color: var(--s-text-secondary); margin-left: 1rem; text-decoration: none;"${3}>Privacy</a><a href="#" style="color: var(--s-text-secondary); margin-left: 1rem; text-decoration: none;"${3}>Terms</a></div></div></footer>`;function x(s,t,o,e){const{d:r,sp:a,st:n}=s;return[n(et,1,[a(6,null,r(t.copyright))])]}var ot=h(x);x.stylesheets=[],x.stylesheetToken="lwc-6rvlaincsff",x.legacyStylesheetToken="components-footer_footer",N&&x.stylesheets.push.apply(x.stylesheets,N),u(x);class D extends f{constructor(...t){super(...t);this.copyright="\xA9 2026 FlexSite"}get year(){return new Date().getFullYear()}}D.renderMode="light",m(D,{publicProps:{copyright:{config:0}}});const st=y(D,{tmpl:ot,sel:"components-footer",apiVersion:66});function rt(s,t,o){var e=s?"["+s+"]":"";return".text-block-wrapper"+e+" {padding: 2rem 0;max-width: 800px;margin: 0 auto;}.text-content"+e+" h2"+e+" {font-size: 2rem;margin-bottom: 1rem;color: var(--s-text-heading);}.text-content"+e+" p"+e+" {font-size: 1.1rem;line-height: 1.6;color: var(--s-text-body);}"}var A=[rt];const at=l`<h2${3}>${"t1"}</h2>`,it={classMap:{"text-block-wrapper":!0},key:0},nt={classMap:{"text-content":!0},context:{lwc:{dom:"manual"}},key:3};function v(s,t,o,e){const{d:r,sp:a,st:n,h:d}=s;return[d("div",it,[t.heading?n(at,2,[a(1,null,r(t.heading))]):null,d("div",nt)])]}var lt=h(v);v.stylesheets=[],v.stylesheetToken="lwc-45ig5r15g8s",v.legacyStylesheetToken="components-textBlock_textBlock",A&&v.stylesheets.push.apply(v.stylesheets,A),u(v);class M extends f{constructor(...t){super(...t);this.heading=void 0,this._content=void 0}get content(){return this._content}set content(t){this._content=t,this.renderHtml()}renderedCallback(){this.renderHtml()}renderHtml(){if(this._content){const t=this.querySelector(".text-content");t&&(t.innerHTML=this._content)}}}M.renderMode="light",m(M,{publicProps:{heading:{config:0},content:{config:3}},fields:["_content"]});const ct=y(M,{tmpl:lt,sel:"components-text-block",apiVersion:66});function pt(s,t,o){var e=s?"["+s+"]":"";return".image-block"+e+" {margin: 2rem 0;text-align: center;}.img-responsive"+e+" {max-width: 100%;height: auto;border-radius: 8px;box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);}figcaption"+e+" {margin-top: 0.5rem;font-size: 0.9rem;color: var(--s-text-secondary);font-style: italic;}"}var R=[pt];const dt=l`<img${"a0:src"}${"a0:alt"} class="img-responsive${0}"${2}>`,gt=l`<figcaption${3}>${"t1"}</figcaption>`,ht={classMap:{"image-block":!0},key:0};function b(s,t,o,e){const{sp:r,st:a,d:n,fr:d,h:g}=s;return[g("figure",ht,[a(dt,2,[r(0,{attrs:{src:t.src,alt:t.alt}},null)]),t.caption?d(3,[a(gt,5,[r(1,null,n(t.caption))])],0):null])]}var ut=h(b);b.stylesheets=[],b.stylesheetToken="lwc-12le0dtu3tq",b.legacyStylesheetToken="components-imageBlock_imageBlock",R&&b.stylesheets.push.apply(b.stylesheets,R),u(b);class B extends f{constructor(...t){super(...t);this.src="",this.alt="",this.caption=""}}B.renderMode="light",m(B,{publicProps:{src:{config:0},alt:{config:0},caption:{config:0}}});const mt=y(B,{tmpl:ut,sel:"components-image-block",apiVersion:66});function yt(s,t,o){var e=s?"["+s+"]":"";return".card-block"+e+" {background: #fff;border-radius: 8px;box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);padding: 1.5rem;margin: 1rem auto;max-width: 400px;transition: transform 0.2s;border: 1px solid var(--s-border-light);}.card-block:hover"+e+" {transform: translateY(-2px);box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);}.card-title"+e+" {font-size: 1.25rem;margin-bottom: 0.5rem;color: var(--s-text-heading);}.card-text"+e+" {color: var(--s-text-body);margin-bottom: 1.5rem;}"}var H=[yt];const ft=l`<h3 class="card-title${0}"${2}>${"t1"}</h3>`,$t=l`<p class="card-text${0}"${2}>${"t1"}</p>`,xt=l`<button class="btn btn--primary${0}"${2}>${"t1"}</button>`,vt={classMap:{"card-block":!0},key:0},bt={classMap:{"card-body":!0},key:1};function _(s,t,o,e){const{d:r,sp:a,st:n,b:d,fr:g,h:c}=s,{_m0:T,_m1:C}=e;return[c("div",vt,[c("div",bt,[n(ft,3,[a(1,null,r(t.title))]),n($t,5,[a(1,null,r(t.content))]),t.action?g(6,[n(xt,8,[a(0,{on:C||(e._m1={click:d(t.handleAction)})},null),a(1,null,r(t.action))])],0):null])])]}var _t=h(_);_.stylesheets=[],_.stylesheetToken="lwc-1b4mq7pplq",_.legacyStylesheetToken="components-cardBlock_cardBlock",H&&_.stylesheets.push.apply(_.stylesheets,H),u(_);class I extends f{constructor(...t){super(...t);this.title="",this.content="",this.action=""}handleAction(){console.log("Card action clicked")}}I.renderMode="light",m(I,{publicProps:{title:{config:0},content:{config:0},action:{config:0}}});const wt=y(I,{tmpl:_t,sel:"components-card-block",apiVersion:66}),kt=l`<div class="loading${0}"${2}><div class="spinner${0}"${2}></div><p${3}>Loading preview...</p></div>`,St=l`<img${"a0:src"}${"a0:alt"}${3}>`,Pt=l`<span class="logo-text${0}"${2}>${"t1"}</span>`,Ct=l`<div style="display: flex; align-items: center; gap: 0.75rem;"${3}><img${"a1:src"}${"a1:alt"} style="max-height: 40px; width: auto;"${3}><span class="logo-text${0}"${2}>${"t3"}</span></div>`,Tt=l`<li${3}><a${"a1:href"}${3}>${"t2"}</a></li>`,Lt=l`<div class="empty-state${0}"${2}><h2${3}>Page Not Found</h2><p${3}>The requested page could not be found.</p><button class="btn-primary${0}"${2}>Back to Editor</button></div>`,Ft={"preview-container":!0},Dt={classMap:{"preview-content":!0},key:1},Mt={classMap:{"page-preview":!0},key:4},Bt={"site-header":!0},It={classMap:{"header-content":!0},key:6},jt={classMap:{"header-logo":!0},key:7},zt={classMap:{"header-nav":!0},key:15},Et={key:16},Nt={"preview-section":!0};function w(s,t,o,e){const{b:r,st:a,sp:n,fr:d,d:g,h:c,k:T,i:C,c:k,f:q}=s,{_m0:U,_m1:V,_m2:G}=e;return[c("div",{classMap:Ft,key:0,on:U||(e._m0={click:r(t.handleGlobalClick)})},[c("div",Dt,[t.isLoading?a(kt,3):null,t.isLoading?null:t.hasPage?c("div",Mt,q([c("header",{classMap:Bt,style:t.headerStyle,key:5},[c("div",It,[c("div",jt,[t.isLogoImage?d(8,[a(St,10,[n(0,{attrs:{src:t.headerConfig.logoSrc,alt:t.headerConfig.logoAlt}},null)])],0):t.isLogoText?d(8,[a(Pt,12,[n(1,null,g(t.headerConfig.logoText))])],0):t.isLogoBoth?d(8,[a(Ct,14,[n(1,{attrs:{src:t.headerConfig.logoSrc,alt:t.headerConfig.logoAlt}},null),n(3,null,g(t.headerConfig.logoText))])],0):null]),c("nav",zt,[c("ul",Et,C(t.headerConfig.navLinks,function(i){return a(Tt,T(18,i.id),[n(1,{on:V||(e._m1={click:r(t.handleGlobalClick)}),attrs:{href:i.url}},null),n(2,null,g(i.label))])}))])])]),C(t.processedSections,function(i){return c("div",{classMap:Nt,style:i.wrapperStyle,key:T(19,i.id)},[i.isHero?k("components-hero",K,{props:{title:i.properties.title,subtitle:i.properties.subtitle,ctaText:i.properties.ctaText,ctaSecondaryText:i.properties.ctaSecondaryText,backgroundImage:i.properties.backgroundImage,textColor:i.properties.textColor},key:20}):null,i.isFeatures?k("components-features",X,{props:{title:i.properties.title,items:i.properties.items},key:21}):null,i.isFooter?k("components-footer",st,{props:{copyright:i.properties.copyright},key:22}):null,i.isText?k("components-text-block",ct,{props:{content:i.properties.content},key:23}):null,i.isImage?k("components-image-block",mt,{props:{src:i.properties.src,alt:i.properties.alt},key:24}):null,i.isCard?k("components-card-block",wt,{props:{title:i.properties.title,description:i.properties.description},key:25}):null])})])):null,t.isLoading||t.hasPage?null:a(Lt,27,[n(5,{on:G||(e._m2={click:r(t.handleBackToEditor)})},null)])])])]}var At=h(w);w.stylesheets=[],w.stylesheetToken="lwc-6qjd57cigl2",w.legacyStylesheetToken="custom-preview_preview",z&&w.stylesheets.push.apply(w.stylesheets,z),u(w);const p=globalThis?.LWR?.env||{};p&&(p.SSR==="true"||p.SSR),p&&p.basePath,p&&p.locale,p&&p.assetBasePath,p&&p.uiBasePath;const Rt=import.meta.env&&import.meta.env.API_URL||process.env.API_URL||"https://backend-six-xi-72.vercel.app",S=`${Rt}/api`;async function Ht(s=null){try{let t;if(s){const o=await fetch(`${S}/sites/${s}`);if(!o.ok)throw new Error("Failed to load site");t=await o.json()}else{const o=await fetch(`${S}/sites`);if(!o.ok)throw new Error("Failed to load sites");const e=await o.json();t=e.length>0?e[0]:null}if(t){const o=await fetch(`${S}/sites/${t.id}/pages`);o.ok?t.pages=await o.json():t.pages=[]}return t}catch(t){throw console.error("\u274C Error loading site:",t),t}}async function qt(s){try{const t=await fetch(`${S}/sites/${s}/theme`);if(!t.ok)throw new Error("Failed to load theme");return await t.json()}catch(t){return console.error("\u274C Error loading theme:",t),null}}async function Ut(s){try{const[t,o]=await Promise.all([fetch(`${S}/pages/${s}`),fetch(`${S}/pages/${s}/components`)]);if(!t.ok||!o.ok)throw new Error("Failed to load page data");const e=await t.json(),r=await o.json();return{...e,layout:{sections:r}}}catch(t){throw console.error(`\u274C Error loading page ${s}:`,t),t}}class j extends f{constructor(...t){super(...t);this.pageData=null,this.currentPage=null,this.sitePages=[],this.isLoading=!0,this.headerConfig={logoType:"text",logoText:"My Site",navLinks:[],backgroundColor:"#ffffff",textColor:"#333333"}}get isLogoText(){return this.headerConfig.logoType==="text"}get isLogoImage(){return this.headerConfig.logoType==="image"}get isLogoBoth(){return this.headerConfig.logoType==="both"}get headerStyle(){return`
            background-color: ${this.headerConfig.backgroundColor};
            color: ${this.headerConfig.textColor};
            min-height: ${this.headerConfig.height||"auto"};
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        `}get rootStyle(){return""}async connectedCallback(){await this.loadPreviewData();const t=localStorage.getItem("headerConfig");if(t)try{this.headerConfig={...this.headerConfig,...JSON.parse(t)}}catch(o){console.error("Failed to parse stored header config",o)}}async loadPreviewData(){try{this.isLoading=!0;const t=await Ht();if(!t)throw new Error("No site found");console.log("\u2713 Site data loaded:",t),this.sitePages=t.pages.map(e=>({...e,label:e.name||e.slug,isCurrent:!1})),this.currentSiteId=t.id;let o=this.getPageIdFromUrl();if(o||(o=t.activePageId||(t.pages.length>0?t.pages[0].id:null)),!o){console.warn("No pages found in site");return}await this.loadPageData(o),await this.applyBrandingColors()}catch(t){console.error("\u274C Failed to load preview:",t),this.currentPage=null}finally{this.isLoading=!1}}async loadPageData(t){try{this.isLoading=!0;const o=await Ut(t);this.currentPage=o,console.log("\u2713 Preview page loaded:",this.currentPage),this.updateNavigationState(t),await this.applyBrandingColors()}catch(o){console.error("\u274C Failed to load page data:",o),this.currentPage=null}finally{this.isLoading=!1}}updateNavigationState(t){this.sitePages=this.sitePages.map(o=>({...o,isCurrent:String(o.id)===String(t),class:String(o.id)===String(t)?"nav-link active":"nav-link"}))}getPageIdFromUrl(){const o=window.location.pathname.match(/\/preview\/([^\/]+)/);return o?o[1]:null}handleNavigation(t){t.preventDefault();const o=t.target.dataset.id;o&&(window.history.pushState({},"",`/preview/${o}`),this.loadPageData(o))}handleBackToEditor(){window.opener?window.close():window.location.href="/"}get hasPage(){return!!this.currentPage}get processedSections(){return!this.currentPage||!this.currentPage.layout||!this.currentPage.layout.sections?[]:this.currentPage.layout.sections.map(t=>({...t,isHero:t.type==="hero",isFeatures:t.type==="features",isFooter:t.type==="footer",isText:t.type==="text",isImage:t.type==="image",isCard:t.type==="card",properties:t.props||t.properties||{},wrapperStyle:`min-height: ${(t.props||t.properties||{}).minHeight||"auto"}; padding-top: ${(t.props||t.properties||{}).paddingTop||"0"}; padding-bottom: ${(t.props||t.properties||{}).paddingBottom||"0"};`}))}async applyBrandingColors(){try{let t=null,o={};if(this.currentSiteId){const r=await qt(this.currentSiteId);r&&r.colors&&(t=r.colors,o=r.typography||{},console.log("\u2713 Loaded theme from database:",r))}if(!t){const r=localStorage.getItem("brandingColors");if(r){const a=JSON.parse(r);t=a,o=a.typography||{},console.log("\u2713 Loaded theme from localStorage")}}if(!t)return;const e=document.body;t.primary&&(e.style.setProperty("--s-bg-primary",t.primary,"important"),e.style.setProperty("--s-bg-primary-hover",this.adjustColor(t.primary,-20),"important"),e.style.setProperty("--p-color-brand-600",t.primary,"important"),e.style.setProperty("--s-border-focus",t.primary,"important")),t.background&&(e.style.setProperty("--s-bg-page",t.background,"important"),e.style.setProperty("--s-bg-surface",t.background,"important")),t.text&&(e.style.setProperty("--s-text-primary",t.text,"important"),e.style.setProperty("--s-text-secondary",this.adjustColor(t.text,40),"important")),o.primary&&(e.style.setProperty("--s-font-family-body",`${o.primary}, sans-serif`,"important"),e.style.setProperty("--s-font-family",`${o.primary}, sans-serif`,"important")),o.heading&&e.style.setProperty("--s-font-family-heading",`${o.heading}, serif`,"important")}catch(t){console.error("Failed to apply branding colors",t)}}adjustColor(t,o){return"#"+t.replace(/^#/,"").replace(/../g,e=>("0"+Math.min(255,Math.max(0,parseInt(e,16)+o)).toString(16)).substr(-2))}handleGlobalClick(t){const o=t.composedPath().find(e=>e.tagName==="A");if(o&&o.href){const e=new URL(o.href);if(e.origin===window.location.origin){if(e.pathname.startsWith("/preview"))return;t.preventDefault(),console.log("Intercepted link:",e.pathname);const r=e.pathname,a=this.sitePages.find(n=>n.slug===r||`/${n.slug}`===r);a?(console.log("Redirecting to preview page:",a.id),window.history.pushState({},"",`/preview/${a.id}`),this.loadPageData(a.id)):console.warn("Target page not found for slug:",r)}}}}j.renderMode="light",m(j,{track:{pageData:1,currentPage:1,sitePages:1,isLoading:1,headerConfig:1}});const Vt=y(j,{tmpl:At,sel:"custom-preview",apiVersion:66});export{Vt as default};
