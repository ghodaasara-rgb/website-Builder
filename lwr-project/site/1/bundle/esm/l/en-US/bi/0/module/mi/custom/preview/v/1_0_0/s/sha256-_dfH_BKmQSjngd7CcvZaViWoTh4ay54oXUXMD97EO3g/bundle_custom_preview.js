import{parseFragment as l,registerTemplate as h,freezeTemplate as u,registerDecorators as m,registerComponent as y,LightningElement as f}from"/1/bundle/esm/l/en-US/bi/0/module/mi/lwc%2Fv%2F8_28_0/s/sha256-YEjxo0QDCp_Ri6v5gTkCFurICNw6jRY4sdZ3D70_fxc/bundle_lwc.js";function W(r,t,s){var e=r?"["+r+"]":"",a=r?"-"+r:"";return".preview-container"+e+" {display: flex;flex-direction: column;height: 100vh;background-color: #f8f9fa;}.preview-header"+e+" {display: flex;justify-content: space-between;align-items: center;padding: 0 24px;height: 64px;background-color: white;border-bottom: 1px solid #e2e8f0;box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);}.preview-header-left"+e+" {display: flex;align-items: center;}.preview-branding"+e+" h1"+e+" {margin: 0;font-size: 18px;font-weight: 600;color: #1a202c;line-height: 1.2;}.preview-branding"+e+" p"+e+" {margin: 0;font-size: 12px;color: #64748b;}.site-preview-nav"+e+" {display: flex;gap: 4px;background: #f1f5f9;padding: 4px;border-radius: 6px;}.nav-link"+e+" {display: inline-block;padding: 6px 12px;color: #64748b;text-decoration: none;font-size: 14px;font-weight: 500;border-radius: 4px;transition: all 0.2s;}.nav-link:hover"+e+" {background-color: #e2e8f0;color: #1e293b;}.nav-link.active"+e+" {background-color: white;color: #0f172a;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);font-weight: 600;}.btn-back"+e+" {padding: 8px 16px;background-color: #4f46e5;color: white;border: none;border-radius: 6px;font-size: 14px;font-weight: 500;cursor: pointer;transition: background-color 0.2s;}.btn-back:hover"+e+" {background-color: #4338ca;}.preview-content"+e+" {flex: 1;overflow-y: auto;padding: 0;}.loading"+e+" {display: flex;flex-direction: column;align-items: center;justify-content: center;height: 400px;gap: 16px;}.spinner"+e+" {width: 40px;height: 40px;border: 4px solid #e2e8f0;border-top-color: #4f46e5;border-radius: 50%;animation: spin"+a+" 0.8s linear infinite;}@keyframes spin"+a+" {to {transform: rotate(360deg);}}.loading"+e+" p"+e+" {color: #64748b;font-size: 14px;}.page-preview"+e+" {background-color: var(--s-bg-page, white);min-height: 100%;padding-bottom: 64px;}.empty-state"+e+" {display: flex;flex-direction: column;align-items: center;justify-content: center;height: 400px;gap: 16px;text-align: center;}.empty-state"+e+" h2"+e+" {font-size: 24px;font-weight: 600;color: #1a202c;margin-bottom: 8px;}.empty-state"+e+" p"+e+" {font-size: 16px;color: #64748b;}.btn-primary"+e+" {padding: 10px 20px;background-color: #4f46e5;color: white;border: none;border-radius: 6px;cursor: pointer;font-weight: 500;}"}var I=[W];function J(r,t,s){var e=r?"["+r+"-host]":"";return(t?":host {":e+" {")+"display: block;}"}var N=[J];const K=l`<section class="container${0}"${"s0"}${2}><div class="grid${0}"${2}><div class="col-span-12${0}" style="text-align: center; z-index: 1; position: relative;"${2}><h1${"s3"}${3}>${"t4"}</h1><p${"s5"}${3}>${"t6"}</p><div style="display: flex; gap: 1rem; justify-content: center;"${3}><a href="#" class="btn btn--primary btn--lg${0}"${2}>${"t9"}</a><a href="#" class="btn btn--secondary btn--lg${0}"${2}>${"t11"}</a></div></div></div></section>`;function $(r,t,s,e){const{d:a,sp:o,st:n}=r;return[n(K,1,[o(0,{style:t.sectionStyle},null),o(3,{style:t.headlineStyle},null),o(4,null,a(t.title)),o(5,{style:t.subtitleStyle},null),o(6,null,a(t.subtitle)),o(9,null,a(t.ctaText)),o(11,null,a(t.ctaSecondaryText))])]}var O=h($);$.stylesheets=[],$.stylesheetToken="lwc-chdq17c5gt",$.legacyStylesheetToken="components-hero_hero",N&&$.stylesheets.push.apply($.stylesheets,N),u($);class F extends f{constructor(...t){super(...t);this.title="Welcome to FlexSite",this.subtitle="Built with the Custom CSS Framework",this.ctaText="Get Started",this.ctaSecondaryText="Learn More",this.backgroundImage="",this.textColor="#ffffff"}get sectionStyle(){const t="padding: 4rem 0;";return this.backgroundImage?`${t} background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('${this.backgroundImage}'); background-size: cover; background-position: center; position: relative;`:t}get headlineStyle(){return`font-size: 2.5rem; font-weight: 700; margin-bottom: 1rem; color: ${this.textColor}; text-shadow: 0 2px 4px rgba(0,0,0,0.5);`}get subtitleStyle(){return`font-size: 1.25rem; margin-bottom: 2rem; color: ${this.textColor}; opacity: 0.95; text-shadow: 0 1px 2px rgba(0,0,0,0.5);`}}F.renderMode="light",m(F,{publicProps:{title:{config:0},subtitle:{config:0},ctaText:{config:0},ctaSecondaryText:{config:0},backgroundImage:{config:0},textColor:{config:0}}});const Q=y(F,{tmpl:O,sel:"components-hero",apiVersion:66}),Z=l`<section class="container${0}" style="padding: 4rem 0;"${2}><h2 style="text-align: center; margin-bottom: 2rem;"${3}>${"t2"}</h2><div class="grid${0}"${2}><div class="col-span-4${0}"${2}><div class="card${0}" style="height: 100%;"${2}><div class="card-header${0}"${2}><h3 class="card-title${0}"${2}>Drag &amp; Drop</h3></div><div class="card-body${0}"${2}><p style="color: var(--s-text-secondary);"${3}>Easily build pages by dragging components.</p></div></div></div><div class="col-span-4${0}"${2}><div class="card${0}" style="height: 100%;"${2}><div class="card-header${0}"${2}><h3 class="card-title${0}"${2}>Responsive</h3></div><div class="card-body${0}"${2}><p style="color: var(--s-text-secondary);"${3}>Layouts adapt perfectly to any device size.</p></div></div></div><div class="col-span-4${0}"${2}><div class="card${0}" style="height: 100%;"${2}><div class="card-header${0}"${2}><h3 class="card-title${0}"${2}>Customizable</h3></div><div class="card-body${0}"${2}><p style="color: var(--s-text-secondary);"${3}>Powered by your Custom CSS Framework.</p></div></div></div></div></section>`;function T(r,t,s,e){const{d:a,sp:o,st:n}=r;return[n(Z,1,[o(2,null,a(t.title))])]}var X=h(T);T.stylesheets=[],T.stylesheetToken="lwc-32bflh7ts20",T.legacyStylesheetToken="components-features_features",u(T);class D extends f{constructor(...t){super(...t);this.title="Features"}}D.renderMode="light",m(D,{publicProps:{title:{config:0}}});const tt=y(D,{tmpl:X,sel:"components-features",apiVersion:66});function et(r,t,s){var e=r?"["+r+"-host]":"";return(t?":host {":e+" {")+"display: block;}"}var j=[et];const st=l`<footer class="container${0}" style="padding: 2rem 0; border-top: 1px solid var(--s-border-default); margin-top: 4rem;"${2}><div class="grid${0}"${2}><div class="col-span-6${0}"${2}><strong style="color: var(--s-text-primary);"${3}>FlexSite</strong><p style="color: var(--s-text-secondary); font-size: 0.875rem;"${3}>${"t6"}</p></div><div class="col-span-6${0}" style="text-align: right;"${2}><a href="#" style="color: var(--s-text-secondary); margin-left: 1rem; text-decoration: none;"${3}>Privacy</a><a href="#" style="color: var(--s-text-secondary); margin-left: 1rem; text-decoration: none;"${3}>Terms</a></div></div></footer>`;function v(r,t,s,e){const{d:a,sp:o,st:n}=r;return[n(st,1,[o(6,null,a(t.copyright))])]}var rt=h(v);v.stylesheets=[],v.stylesheetToken="lwc-6rvlaincsff",v.legacyStylesheetToken="components-footer_footer",j&&v.stylesheets.push.apply(v.stylesheets,j),u(v);class B extends f{constructor(...t){super(...t);this.copyright="\xA9 2026 FlexSite"}get year(){return new Date().getFullYear()}}B.renderMode="light",m(B,{publicProps:{copyright:{config:0}}});const at=y(B,{tmpl:rt,sel:"components-footer",apiVersion:66});function ot(r,t,s){var e=r?"["+r+"]":"";return".text-block-wrapper"+e+" {padding: 2rem 0;max-width: 800px;margin: 0 auto;}.text-content"+e+" h2"+e+" {font-size: 2rem;margin-bottom: 1rem;color: var(--s-text-heading);}.text-content"+e+" p"+e+" {font-size: 1.1rem;line-height: 1.6;color: var(--s-text-body);}"}var R=[ot];const it=l`<h2${3}>${"t1"}</h2>`,nt={classMap:{"text-block-wrapper":!0},key:0},lt={classMap:{"text-content":!0},context:{lwc:{dom:"manual"}},key:3};function b(r,t,s,e){const{d:a,sp:o,st:n,h:p}=r;return[p("div",nt,[t.heading?n(it,2,[o(1,null,a(t.heading))]):null,p("div",lt)])]}var ct=h(b);b.stylesheets=[],b.stylesheetToken="lwc-45ig5r15g8s",b.legacyStylesheetToken="components-textBlock_textBlock",R&&b.stylesheets.push.apply(b.stylesheets,R),u(b);class M extends f{constructor(...t){super(...t);this.heading=void 0,this._content=void 0}get content(){return this._content}set content(t){this._content=t,this.renderHtml()}renderedCallback(){this.renderHtml()}renderHtml(){if(this._content){const t=this.querySelector(".text-content");t&&(t.innerHTML=this._content)}}}M.renderMode="light",m(M,{publicProps:{heading:{config:0},content:{config:3}},fields:["_content"]});const pt=y(M,{tmpl:ct,sel:"components-text-block",apiVersion:66});function dt(r,t,s){var e=r?"["+r+"]":"";return".image-block"+e+" {margin: 2rem 0;text-align: center;}.img-responsive"+e+" {max-width: 100%;height: auto;border-radius: 8px;box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);}figcaption"+e+" {margin-top: 0.5rem;font-size: 0.9rem;color: var(--s-text-secondary);font-style: italic;}"}var A=[dt];const gt=l`<img${"a0:src"}${"a0:alt"} class="img-responsive${0}"${2}>`,ht=l`<figcaption${3}>${"t1"}</figcaption>`,ut={classMap:{"image-block":!0},key:0};function x(r,t,s,e){const{sp:a,st:o,d:n,fr:p,h:P}=r;return[P("figure",ut,[o(gt,2,[a(0,{attrs:{src:t.src,alt:t.alt}},null)]),t.caption?p(3,[o(ht,5,[a(1,null,n(t.caption))])],0):null])]}var mt=h(x);x.stylesheets=[],x.stylesheetToken="lwc-12le0dtu3tq",x.legacyStylesheetToken="components-imageBlock_imageBlock",A&&x.stylesheets.push.apply(x.stylesheets,A),u(x);class L extends f{constructor(...t){super(...t);this.src="",this.alt="",this.caption=""}}L.renderMode="light",m(L,{publicProps:{src:{config:0},alt:{config:0},caption:{config:0}}});const yt=y(L,{tmpl:mt,sel:"components-image-block",apiVersion:66});function ft(r,t,s){var e=r?"["+r+"]":"";return".card-block"+e+" {background: #fff;border-radius: 8px;box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);padding: 1.5rem;margin: 1rem auto;max-width: 400px;transition: transform 0.2s;border: 1px solid var(--s-border-light);}.card-block:hover"+e+" {transform: translateY(-2px);box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);}.card-title"+e+" {font-size: 1.25rem;margin-bottom: 0.5rem;color: var(--s-text-heading);}.card-text"+e+" {color: var(--s-text-body);margin-bottom: 1.5rem;}"}var H=[ft];const $t=l`<h3 class="card-title${0}"${2}>${"t1"}</h3>`,vt=l`<p class="card-text${0}"${2}>${"t1"}</p>`,bt=l`<button class="btn btn--primary${0}"${2}>${"t1"}</button>`,xt={classMap:{"card-block":!0},key:0},_t={classMap:{"card-body":!0},key:1};function _(r,t,s,e){const{d:a,sp:o,st:n,b:p,fr:P,h:g}=r,{_m0:C,_m1:d}=e;return[g("div",xt,[g("div",_t,[n($t,3,[o(1,null,a(t.title))]),n(vt,5,[o(1,null,a(t.content))]),t.action?P(6,[n(bt,8,[o(0,{on:d||(e._m1={click:p(t.handleAction)})},null),o(1,null,a(t.action))])],0):null])])]}var wt=h(_);_.stylesheets=[],_.stylesheetToken="lwc-1b4mq7pplq",_.legacyStylesheetToken="components-cardBlock_cardBlock",H&&_.stylesheets.push.apply(_.stylesheets,H),u(_);class z extends f{constructor(...t){super(...t);this.title="",this.content="",this.action=""}handleAction(){console.log("Card action clicked")}}z.renderMode="light",m(z,{publicProps:{title:{config:0},content:{config:0},action:{config:0}}});const kt=y(z,{tmpl:wt,sel:"components-card-block",apiVersion:66}),St=l`<div class="preview-header-left${0}"${2}><div class="preview-branding${0}"${2}><h1${3}>Preview Mode</h1><p${3}>Viewing saved website</p></div></div>`,Pt=l`<a href="#"${"c0"}${"a0:data-id"}${2}>${"t1"}</a>`,Tt=l`<button class="btn-back${0}"${2}>‚Üê Back to Editor</button>`,Ct=l`<div class="loading${0}"${2}><div class="spinner${0}"${2}></div><p${3}>Loading preview...</p></div>`,Ft=l`<div class="empty-state${0}"${2}><h2${3}>Page Not Found</h2><p${3}>The requested page could not be found.</p><button class="btn-primary${0}"${2}>Back to Editor</button></div>`,Dt={"preview-container":!0},Bt={classMap:{"preview-header":!0},key:1},Mt={classMap:{"site-preview-nav":!0},key:4},Lt={classMap:{"preview-content":!0},key:9},zt={classMap:{"page-preview":!0},key:12},Et={"preview-section":!0};function w(r,t,s,e){const{b:a,st:o,ncls:n,k:p,d:P,sp:g,i:C,h:d,c:k,f:V}=r,{_m0:q,_m1:Vt,_m2:U,_m3:qt,_m4:Y,_m5:G}=e;return[d("div",{classMap:Dt,key:0,on:q||(e._m0={click:a(t.handleGlobalClick)})},[d("div",Bt,[o(St,3),d("nav",Mt,C(t.sitePages,function(i){return o(Pt,p(6,i.id),[g(0,{on:U||(e._m2={click:a(t.handleNavigation)}),className:n(i.class),attrs:{"data-id":i.id}},null),g(1,null,P(i.label))])})),o(Tt,8,[g(0,{on:Y||(e._m4={click:a(t.handleBackToEditor)})},null)])]),d("div",Lt,[t.isLoading?o(Ct,11):null,t.isLoading?null:t.hasPage?d("div",zt,V([C(t.processedSections,function(i){return d("div",{classMap:Et,key:p(13,i.id)},[i.isHero?k("components-hero",Q,{props:{title:i.properties.title,subtitle:i.properties.subtitle,ctaText:i.properties.ctaText,ctaSecondaryText:i.properties.ctaSecondaryText,backgroundImage:i.properties.backgroundImage,textColor:i.properties.textColor},key:14}):null,i.isFeatures?k("components-features",tt,{props:{title:i.properties.title,items:i.properties.items},key:15}):null,i.isFooter?k("components-footer",at,{props:{copyright:i.properties.copyright},key:16}):null,i.isText?k("components-text-block",pt,{props:{content:i.properties.content},key:17}):null,i.isImage?k("components-image-block",yt,{props:{src:i.properties.src,alt:i.properties.alt},key:18}):null,i.isCard?k("components-card-block",kt,{props:{title:i.properties.title,description:i.properties.description},key:19}):null])})])):null,t.isLoading||t.hasPage?null:o(Ft,21,[g(5,{on:G||(e._m5={click:a(t.handleBackToEditor)})},null)])])])]}var It=h(w);w.stylesheets=[],w.stylesheetToken="lwc-6qjd57cigl2",w.legacyStylesheetToken="custom-preview_preview",I&&w.stylesheets.push.apply(w.stylesheets,I),u(w);const c=globalThis?.LWR?.env||{};c&&(c.SSR==="true"||c.SSR),c&&c.basePath,c&&c.locale,c&&c.assetBasePath,c&&c.uiBasePath;const Nt=import.meta.env&&import.meta.env.API_URL||process.env.API_URL||"https://backend-six-xi-72.vercel.app",S=`${Nt}/api`;async function jt(r=null){try{let t;if(r){const s=await fetch(`${S}/sites/${r}`);if(!s.ok)throw new Error("Failed to load site");t=await s.json()}else{const s=await fetch(`${S}/sites`);if(!s.ok)throw new Error("Failed to load sites");const e=await s.json();t=e.length>0?e[0]:null}if(t){const s=await fetch(`${S}/sites/${t.id}/pages`);s.ok?t.pages=await s.json():t.pages=[]}return t}catch(t){throw console.error("\u274C Error loading site:",t),t}}async function Rt(r){try{const t=await fetch(`${S}/sites/${r}/theme`);if(!t.ok)throw new Error("Failed to load theme");return await t.json()}catch(t){return console.error("\u274C Error loading theme:",t),null}}async function At(r){try{const[t,s]=await Promise.all([fetch(`${S}/pages/${r}`),fetch(`${S}/pages/${r}/components`)]);if(!t.ok||!s.ok)throw new Error("Failed to load page data");const e=await t.json(),a=await s.json();return{...e,layout:{sections:a}}}catch(t){throw console.error(`\u274C Error loading page ${r}:`,t),t}}class E extends f{constructor(...t){super(...t);this.pageData=null,this.currentPage=null,this.sitePages=[],this.isLoading=!0}async connectedCallback(){await this.loadPreviewData()}async loadPreviewData(){try{this.isLoading=!0;const t=await jt();if(!t)throw new Error("No site found");console.log("\u2713 Site data loaded:",t),this.sitePages=t.pages.map(e=>({...e,label:e.name||e.slug,isCurrent:!1})),this.currentSiteId=t.id;let s=this.getPageIdFromUrl();if(s||(s=t.activePageId||(t.pages.length>0?t.pages[0].id:null)),!s){console.warn("No pages found in site");return}await this.loadPageData(s),await this.applyBrandingColors()}catch(t){console.error("\u274C Failed to load preview:",t),this.currentPage=null}finally{this.isLoading=!1}}async loadPageData(t){try{this.isLoading=!0;const s=await At(t);this.currentPage=s,console.log("\u2713 Preview page loaded:",this.currentPage),this.updateNavigationState(t),await this.applyBrandingColors()}catch(s){console.error("\u274C Failed to load page data:",s),this.currentPage=null}finally{this.isLoading=!1}}updateNavigationState(t){this.sitePages=this.sitePages.map(s=>({...s,isCurrent:String(s.id)===String(t),class:String(s.id)===String(t)?"nav-link active":"nav-link"}))}getPageIdFromUrl(){const s=window.location.pathname.match(/\/preview\/([^\/]+)/);return s?s[1]:null}handleNavigation(t){t.preventDefault();const s=t.target.dataset.id;s&&(window.history.pushState({},"",`/preview/${s}`),this.loadPageData(s))}handleBackToEditor(){window.opener?window.close():window.location.href="/"}get hasPage(){return!!this.currentPage}get processedSections(){return!this.currentPage||!this.currentPage.layout||!this.currentPage.layout.sections?[]:this.currentPage.layout.sections.map(t=>({...t,isHero:t.type==="hero",isFeatures:t.type==="features",isFooter:t.type==="footer",isText:t.type==="text",isImage:t.type==="image",isCard:t.type==="card",properties:t.props||t.properties||{}}))}async applyBrandingColors(){try{let t=null,s={};if(this.currentSiteId){const a=await Rt(this.currentSiteId);a&&a.colors&&(t=a.colors,s=a.typography||{},console.log("\u2713 Loaded theme from database:",a))}if(!t){const a=localStorage.getItem("brandingColors");if(a){const o=JSON.parse(a);t=o,s=o.typography||{},console.log("\u2713 Loaded theme from localStorage")}}if(!t)return;const e=document.body;t.primary&&(e.style.setProperty("--s-bg-primary",t.primary,"important"),e.style.setProperty("--s-bg-primary-hover",this.adjustColor(t.primary,-20),"important"),e.style.setProperty("--p-color-brand-600",t.primary,"important"),e.style.setProperty("--s-border-focus",t.primary,"important")),t.background&&(e.style.setProperty("--s-bg-page",t.background,"important"),e.style.setProperty("--s-bg-surface",t.background,"important")),t.text&&(e.style.setProperty("--s-text-primary",t.text,"important"),e.style.setProperty("--s-text-secondary",this.adjustColor(t.text,40),"important")),s.primary&&(e.style.setProperty("--s-font-family-body",`${s.primary}, sans-serif`,"important"),e.style.setProperty("--s-font-family",`${s.primary}, sans-serif`,"important")),s.heading&&e.style.setProperty("--s-font-family-heading",`${s.heading}, serif`,"important")}catch(t){console.error("Failed to apply branding colors",t)}}adjustColor(t,s){return"#"+t.replace(/^#/,"").replace(/../g,e=>("0"+Math.min(255,Math.max(0,parseInt(e,16)+s)).toString(16)).substr(-2))}handleGlobalClick(t){const s=t.composedPath().find(e=>e.tagName==="A");if(s&&s.href){const e=new URL(s.href);if(e.origin===window.location.origin){if(e.pathname.startsWith("/preview"))return;t.preventDefault(),console.log("Intercepted link:",e.pathname);const a=e.pathname,o=this.sitePages.find(n=>n.slug===a||`/${n.slug}`===a);o?(console.log("Redirecting to preview page:",o.id),window.history.pushState({},"",`/preview/${o.id}`),this.loadPageData(o.id)):console.warn("Target page not found for slug:",a)}}}}E.renderMode="light",m(E,{track:{pageData:1,currentPage:1,sitePages:1,isLoading:1}});const Ht=y(E,{tmpl:It,sel:"custom-preview",apiVersion:66});export{Ht as default};
